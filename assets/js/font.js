!function(r){"use strict";function n(t,e){var n=this;n.$el=t,n.options=e,n.settings=n.options.settings,n.$family=n.$el.find(n.options.family),n.$subset=n.$el.find(n.options.subset),n.$variant=n.$el.find(n.options.variant),n.$size=n.$el.find(n.options.size),n.$lineheight=n.$el.find(n.options.lineheight),n.$letterspacing=n.$el.find(n.options.letterspacing),n.$color=n.$el.find(n.options.color),n.$canvas=n.$el.find(n.options.canvas),n.$color.wpColorPicker(r.extend(n.settings.color,{change:function(t,e){n.update_canvas("color",e.color.toString())},clear:function(t){n.update_canvas("color","#000000")}})),n.$family.on("change",r.proxy(n.update_subset_variant,n)),r([n.$size,n.$lineheight,n.$letterspacing]).each(function(){r(this).on("keyup",n.delay(r.proxy(n.input_keyup,n),500))}),r([n.$family,n.$subset,n.$variant]).each(function(){r(this).on("change",r.proxy(n.select_change,n))}),n.update_subset_variant(),n.update_canvas()}n.prototype.$canvas=null,n.prototype.$color=null,n.prototype.$el=null,n.prototype.$family=null,n.prototype.$letterspacing=null,n.prototype.$lineheight=null,n.prototype.options=null,n.prototype.settings=null,n.prototype.$subset=null,n.prototype.$variant=null,n.prototype.delay=function(n,a){var o=0;return function(){var t=this,e=arguments;clearTimeout(o),o=setTimeout(function(){n.apply(t,e)},a||0)}},n.prototype.input_keyup=function(t){t.preventDefault();var e=r(t.target||t.currentTarget),n=e.attr("data-style"),a=e.val();void 0!==n&&!1!==n&&this.update_canvas(n,a)},n.prototype.select_change=function(t){t.preventDefault();var e=r(t.target||t.currentTarget),n=e.attr("data-style"),a=e.children("option:selected").val();this.update_canvas(n,a)},n.prototype.update_canvas=function(t,e){var n=this;2===arguments.length&&""!==e?n.$canvas.css(t,e):(r([n.$backup,n.$size,n.$lineheight,n.$letterspacing,n.$color]).each(function(){var t=r(this);n.$canvas.css(t.attr("data-style"),t.val())}),r([n.$family,n.$subset,n.$variant]).each(function(){var t=r(this),e=t.attr("data-style");n.$canvas.css(e,t.children("option:selected").val())}));var a=n.$canvas.find("link"),o=n.$family.children("option:selected").val().replace(/ /g,"+");if(a.length&&a.remove(),"googlefonts"===n.options.mode&&""!==o){var i="https://fonts.googleapis.com/css?family=",s=n.$variant.children("option:selected").val(),l=n.$subset.children("option:selected").val();i+=o,i+=""===s?"":":"+s,i+=""===l?"":"&"+l,n.$canvas.append('<link rel="stylesheet" href="'+i+'">')}},n.prototype.update_subset_variant=function(){var n=this;""!==n.$family.children("option:selected").val()&&r.ajax(ajaxurl,{type:"POST",data:{action:n.options.ajax,family:n.$family.children("option:selected").val(),mode:n.options.mode},dataType:"json"}).done(function(t){if(t.success){var e=JSON.parse(t.data);n.$subset.html(""),r.each(e.subsets,function(t,e){n.$subset.append('<option value="'+e+'">'+e+"</option>")}),n.$variant.html(""),r.each(e.variants,function(t,e){n.$variant.append('<option value="'+e+'">'+e+"</option>")}),n.update_canvas()}})};var e={init:function(t){if(!this.length)return!1;var e={color:".input-color",family:".input-family",letterspacing:".input-letterspacing",lineheight:".input-lineheight",size:".input-size",subset:".input-subset",variant:".input-variant",ajax:"font-identifier",canvas:".canvas p",mode:"googlefonts",settings:{color:{defaultColor:!0,hide:!0,palettes:!0,width:255,mode:"hsv",type:"full",slider:"horizontal"}}};return this.each(function(){t&&r.extend(e,t),new n(r(this),e)})}};r.fn.dionysosFont=function(t){return e[t]?e[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof t&&t?(r.error("Method "+t+" does not exist on dionysosFont"),!1):e.init.apply(this,arguments)}}(window.jQuery);